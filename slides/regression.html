<!DOCTYPE html>
<html lang="en"><head>
<script src="regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="regression_files/libs/quarto-html/tabby.min.js"></script>
<script src="regression_files/libs/quarto-html/popper.min.js"></script>
<script src="regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="regression_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="regression_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="regression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Harper Adams University">
  <title>Linear Regression</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="regression_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="regression_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="regression_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="scroll.css">
  <link href="regression_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="regression_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="regression_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="regression_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Linear Regression</h1>
  <p class="subtitle">Concepts and intuition</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Harper Adams University 
</div>
</div>
</div>

</section>
<section id="what-were-doing-today" class="slide level2">
<h2>What we’re doing today</h2>
<p>By the end, you should be able to:</p>
<ul>
<li>Explain what a <em>linear model</em> is (and what “linear” actually means)</li>
<li>Fit and interpret a simple linear regression in R (<code>lm()</code>)</li>
<li>Distinguish <em>prediction</em> vs <em>explanation</em> (and the traps in each)</li>
<li>Check assumptions with diagnostic plots</li>
<li>Report results in a professional, reproducible way</li>
<li>Recognise when you need extensions: multiple predictors, interactions, blocks, random intercepts</li>
</ul>
<aside class="notes">
<p>Suggested pacing: - Part A: what a model is + regression idea - Part B: fit, interpret, confidence intervals, R², p-values - Break: quick stretch - Part C: diagnostics + fixes - Part D: extensions + reporting + mini-assessment</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="setup-r" class="slide level2">
<h2>Setup (R)</h2>
<p>We’ll use a small, friendly dataset.</p>
<aside class="notes">
<p>If you prefer: swap in mtcars or your own agronomy dataset. We use penguins because it has clear relationships and is widely used in teaching.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

</section>
<section>
<section id="part-a-what-is-a-statistical-model" class="title-slide slide level1 center">
<h1>Part A — What is a statistical model?</h1>

</section>
<section id="definition-statistical-model" class="slide level2">
<h2>Definition: statistical model</h2>
<p>A <strong>statistical model</strong> is a simplified mathematical description of a real system.</p>
<ul>
<li>It focuses on relationships between variables (and uncertainty),</li>
<li>not just <em>drawing a curve through points</em>.</li>
</ul>
</section>
<section id="linear-vs-non-linear-intuition" class="slide level2">
<h2>Linear vs non-linear (intuition)</h2>
<p>A relationship can be:</p>
<ul>
<li><strong>linear additive</strong>: a fixed change in <em>x</em> gives a fixed change in expected <em>y</em></li>
<li><strong>non-linear</strong>: diminishing returns, saturation, thresholds, etc.</li>
</ul>
<aside class="notes">
<p>Use this to motivate “linear regression is a tool, not the truth”.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linear-vs-non-linear" class="slide level2">
<h2>Linear vs non-linear</h2>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section id="linear-means-linear-in-the-parameters" class="slide level2">
<h2>“Linear” means linear in the parameters</h2>
<p>A <strong>linear model</strong> can include transformed predictors:</p>
<ul>
<li>✅ <code>y = β0 + β1 x + β2 x^2 + ε</code> is <em>linear in β’s</em></li>
<li>✅ <code>y = β0 + β1 log(x) + ε</code> is <em>linear in β’s</em></li>
<li>❌ <code>y = β0 + exp(β1 x) + ε</code> is <em>not</em> linear in β’s</li>
</ul>
</section>
<section id="the-linear-model-in-matrix-form" class="slide level2">
<h2>The linear model in matrix form</h2>
<p><span class="math display">\[
\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}
\]</span></p>
<ul>
<li><strong>y</strong>: response/outcome</li>
<li><strong>X</strong>: design matrix (predictors encoded as columns)</li>
<li><strong>β</strong>: coefficients/parameters</li>
<li><strong>ε</strong>: residual error (unexplained part)</li>
</ul>
</section>
<section id="what-regression-is-for" class="slide level2">
<h2>What regression is for</h2>
<p>Simple regression often answers at least one of:</p>
<ul>
<li><strong>Prediction</strong>: estimate <em>y</em> at new <em>x</em></li>
<li><strong>Explanation</strong>: quantify change in <em>y</em> per unit <em>x</em></li>
<li><strong>Variance accounting</strong>: how much variation in <em>y</em> is associated with <em>x</em></li>
<li><strong>Inference</strong>: hypothesis tests and confidence intervals</li>
</ul>
</section>
<section id="regression-to-the-mean-intuition" class="slide level2">
<h2>Regression to the mean (intuition)</h2>
<p><strong>Regression to the mean</strong> happens when you pick people (or things) because they had an <strong>extreme result once</strong>, then measure them again.</p>
<p><strong>What you see:</strong> the extreme scores move closer to average on the second measurement.</p>
<p><strong>Why?</strong> Every measurement has some <strong>randomness</strong> (luck, conditions, mood, error). When you pick “the best” or “the worst” from one measurement, you accidentally pick people who got lucky (or unlucky) that day. Next time, their luck is different—so their score drifts back toward their usual level.</p>
<p><strong>Key examples:</strong></p>
<ul>
<li>Students who bombed an exam → tend to do better on a retest (even with no extra study)</li>
<li>“Rookie of the year” → often has a more normal second season</li>
<li>Worst-performing stores → often improve next quarter (even with no intervention)</li>
</ul>
<p><strong>The trap:</strong> this looks like improvement (or decline), but it’s just randomness evening out. <strong>Nothing actually changed.</strong></p>
</section>
<section id="why-is-it-called-regression" class="slide level2">
<h2>Why is it called “regression”?</h2>
<p><strong>The connection:</strong> linear regression literally models regression to the mean.</p>
<p><strong>History:</strong> Francis Galton (1886) studied parent and child heights. He noticed:</p>
<ul>
<li>Very tall parents → children are tall, but closer to average height</li>
<li>Very short parents → children are short, but closer to average height</li>
</ul>
<p>He called this <strong>“regression toward mediocrity”</strong> (we now say “regression to the mean”).</p>
<p><strong>Mathematics:</strong> When you fit a regression line <span class="math inline">\(\hat{y} = \alpha + \beta x\)</span>, you’re estimating the <strong>conditional mean</strong>: the average <em>y</em> for a given <em>x</em>.</p>
<ul>
<li>If correlation is perfect (<span class="math inline">\(\rho = 1\)</span>), the line has slope = 1 (no regression to mean)</li>
<li>If correlation is imperfect (<span class="math inline">\(\rho &lt; 1\)</span>), the line is <strong>flatter</strong> than 45°, which means extreme <em>x</em> values predict <em>y</em> values closer to the mean</li>
</ul>
<p><strong>So:</strong> linear regression is the mathematical tool that quantifies how much extreme values regress back toward the mean. The phenomenon gave the method its name!</p>
</section>
<section id="caution-correlation-causation" class="slide level2">
<h2>Caution: correlation ≠ causation</h2>
<p>Regression describes association <em>in your dataset</em>.</p>
<p>To talk about causality you need:</p>
<ul>
<li>design (randomisation, controls),</li>
<li>or a strong causal argument (assumptions you can defend).</li>
</ul>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="part-b-simple-linear-regression" class="title-slide slide level1 center">
<h1>Part B — Simple linear regression</h1>

</section>
<section id="the-simple-regression-model" class="slide level2">
<h2>The simple regression model</h2>
<p><span class="math display">\[
y_i = \alpha + \beta x_i + \varepsilon_i,\quad \varepsilon_i \sim \mathcal{N}(0, \sigma^2)
\]</span></p>
<ul>
<li><strong>α</strong>: intercept (expected <em>y</em> when <em>x = 0</em>)</li>
<li><strong>β</strong>: slope (change in expected <em>y</em> for +1 in <em>x</em>)</li>
<li><strong>ε</strong>: residual (what’s left)</li>
</ul>
</section>
<section id="example-body-mass-vs-bill-length" class="slide level2">
<h2>Example: body mass vs bill length</h2>
<p>Here’s the relationship we’ll model:</p>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="fit-the-model-with-lm" class="slide level2">
<h2>Fit the model with <code>lm()</code></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ bill_length_mm, data = penguins)

Coefficients:
   (Intercept)  bill_length_mm  
        362.31           87.42  </code></pre>
</div>
</div>
</section>
<section id="add-the-regression-line" class="slide level2">
<h2>Add the regression line</h2>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="model-coefficients" class="slide level2">
<h2>Model coefficients</h2>
<p>The fitted regression coefficients with 95% confidence intervals:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">362.31</td>
<td style="text-align: right;">283.35</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">-195.02</td>
<td style="text-align: right;">919.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">bill_length_mm</td>
<td style="text-align: right;">87.42</td>
<td style="text-align: right;">6.40</td>
<td style="text-align: right;">13.65</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">74.82</td>
<td style="text-align: right;">100.01</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Interpretation template:</p>
<ul>
<li><strong>Slope β:</strong> for a 1-unit increase in <em>x</em>, expected <em>y</em> changes by β (holding other predictors constant)</li>
<li><strong>Intercept α:</strong> expected <em>y</em> when <em>x = 0</em> (sometimes not meaningful!)</li>
</ul>
</section>
<section id="prediction-vs-residuals" class="slide level2">
<h2>Prediction vs residuals</h2>
<p>Two concepts:</p>
<ul>
<li><strong>Fitted value</strong>: <span class="math inline">\(\hat{y}_i\)</span> (model’s predicted mean)</li>
<li><strong>Residual</strong>: <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span></li>
</ul>
<p>First few observations with fitted values and residuals:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Body mass (g)</th>
<th style="text-align: right;">Bill length (mm)</th>
<th style="text-align: right;">Fitted</th>
<th style="text-align: right;">Residual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3750</td>
<td style="text-align: right;">39.1</td>
<td style="text-align: right;">3780.2</td>
<td style="text-align: right;">-30.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3800</td>
<td style="text-align: right;">39.5</td>
<td style="text-align: right;">3815.2</td>
<td style="text-align: right;">-15.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3250</td>
<td style="text-align: right;">40.3</td>
<td style="text-align: right;">3885.1</td>
<td style="text-align: right;">-635.1</td>
</tr>
<tr class="even">
<td style="text-align: right;">3450</td>
<td style="text-align: right;">36.7</td>
<td style="text-align: right;">3570.4</td>
<td style="text-align: right;">-120.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3650</td>
<td style="text-align: right;">39.3</td>
<td style="text-align: right;">3797.7</td>
<td style="text-align: right;">-147.7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3625</td>
<td style="text-align: right;">38.9</td>
<td style="text-align: right;">3762.8</td>
<td style="text-align: right;">-137.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="where-do-the-coefficients-come-from" class="slide level2">
<h2>Where do the coefficients come from?</h2>
<h3 id="ordinary-least-squares-ols">Ordinary Least Squares (OLS)</h3>
<p><strong>Ordinary least squares</strong> chooses alpha, beta to minimise:</p>
<p><span class="math display">\[
\sum_i (y_i - \hat{y}_i)^2
\]</span></p>
<p>This is the <strong>sum of squared residuals</strong>.</p>
<h3 id="why-least-squares">Why <em>least squares</em>?</h3>
<ul>
<li>Squaring makes all errors positive</li>
<li>Larger errors are penalised more heavily</li>
<li>The mathematics becomes tractable (closed-form solution)</li>
</ul>
<h3 id="why-ordinary">Why <em>ordinary</em>?</h3>
<p>Because we assume:</p>
<ul>
<li>all observations have <strong>equal variance</strong></li>
<li>all observations are <strong>equally reliable</strong></li>
<li>errors are <strong>independent</strong></li>
</ul>
<p>If these are not true, we move to:</p>
<ul>
<li><strong>Weighted least squares</strong> (different variances)</li>
<li><strong>Generalised least squares</strong> (correlated errors)</li>
<li><strong>Mixed models</strong> (hierarchical structure)</li>
</ul>
<p>So “ordinary” = <em>the simplest, default case</em>.</p>
<p><strong>Ordinary least squares (OLS)</strong> chooses α, β that minimise:</p>
<p><span class="math display">\[
\sum_i (y_i - \hat{y}_i)^2
\]</span></p>
<p>This is why you’ll hear <em>“least squares line of best fit”</em>.</p>
</section>
<section id="r²-variance-explained" class="slide level2">
<h2>R² (variance explained)</h2>
<p>How much variation does the model explain?</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">R²</th>
<th style="text-align: right;">Adjusted R²</th>
<th style="text-align: right;">Residual SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.354</td>
<td style="text-align: right;">0.352</td>
<td style="text-align: right;">645.433</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Caution:</p>
<ul>
<li>high R² ≠ causal truth</li>
<li>R² can increase just by adding predictors (use adjusted R², or better, validation)</li>
</ul>
</section>
<section id="p-values-confidence-intervals-and-power" class="slide level2">
<h2>p-values, confidence intervals, and power</h2>
<p>Full model summary:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ bill_length_mm, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max 
-1762.08  -446.98    32.59   462.31  1636.86 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     362.307    283.345   1.279    0.202    
bill_length_mm   87.415      6.402  13.654   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 645.4 on 340 degrees of freedom
Multiple R-squared:  0.3542,    Adjusted R-squared:  0.3523 
F-statistic: 186.4 on 1 and 340 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<h3 id="what-is-being-tested">What is being tested?</h3>
<p>For each coefficient <span class="math inline">\(\beta_j\)</span>, the null hypothesis is:</p>
<p><span class="math display">\[
H_0: \beta_j = 0
\]</span></p>
<p>The test statistic is:</p>
<p><span class="math display">\[
t = \frac{\hat{\beta}_j}{SE(\hat{\beta}_j)}
\]</span></p>
<p>This follows a t-distribution under the model assumptions.</p>
<h3 id="anova-view-of-regression">ANOVA view of regression</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: body_mass_g
                Df    Sum Sq  Mean Sq F value    Pr(&gt;F)    
bill_length_mm   1  77669072 77669072  186.44 &lt; 2.2e-16 ***
Residuals      340 141638626   416584                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>ANOVA partitions variance into:</p>
<ul>
<li><strong>Model (Regression)</strong> sum of squares</li>
<li><strong>Residual (Error)</strong> sum of squares</li>
</ul>
<p>The F-statistic is:</p>
<p><span class="math display">\[
F = \frac{MS_{model}}{MS_{error}}
\]</span></p>
<p>If this ratio is large, the model explains much more variance than expected by chance.</p>
<h3 id="confidence-intervals">Confidence intervals</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                    2.5 %   97.5 %
(Intercept)    -195.02364 919.6371
bill_length_mm   74.82279 100.0078</code></pre>
</div>
</div>
<p>A 95% CI is the range of slopes compatible with the data under the model.</p>
</section>
<section id="interpreting-the-regression-table" class="slide level2">
<h2>Interpreting the regression table</h2>
<p>The coefficient table shows estimates, standard errors, t-statistics, and p-values:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">362.307</td>
<td style="text-align: right;">283.345</td>
<td style="text-align: right;">1.279</td>
<td style="text-align: right;">0.202</td>
</tr>
<tr class="even">
<td style="text-align: left;">bill_length_mm</td>
<td style="text-align: right;">87.415</td>
<td style="text-align: right;">6.402</td>
<td style="text-align: right;">13.654</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Typical output:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Term</th>
<th>Estimate</th>
<th>Std. Error</th>
<th>t value</th>
<th>Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>alpha</td>
<td>SE(alpha)</td>
<td>t</td>
<td>p</td>
</tr>
<tr class="even">
<td>x</td>
<td>beta</td>
<td>SE(beta)</td>
<td>t</td>
<td>p</td>
</tr>
</tbody>
</table>
<h3 id="how-to-read-this">How to read this</h3>
<ul>
<li><strong>Estimate</strong>: the fitted coefficient (alpha or beta)</li>
<li><strong>Std. Error</strong>: uncertainty in that estimate</li>
<li><strong>t value</strong>: Estimate / Std. Error</li>
<li><strong>Pr(&gt;|t|)</strong>: p-value for H0: coefficient = 0</li>
</ul>
<h3 id="intercept">Intercept</h3>
<p>The intercept is the expected value of y when <strong>all predictors = 0</strong>.</p>
<ul>
<li>Sometimes meaningful (e.g.&nbsp;baseline control)</li>
<li>Often meaningless (e.g.&nbsp;bill length = 0 mm is impossible)</li>
</ul>
<h3 id="slope-beta">Slope (beta)</h3>
<p>The slope is the <strong>expected change in y per 1-unit increase in x</strong>, holding other predictors constant.</p>
<p>Units always matter:</p>
<blockquote>
<p>g per mm, kg per ha, t per °C, etc.</p>
</blockquote>
<h3 id="with-factors">With factors</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ species, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max 
-1126.02  -333.09   -33.09   316.91  1223.98 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       3700.66      37.62   98.37   &lt;2e-16 ***
speciesChinstrap    32.43      67.51    0.48    0.631    
speciesGentoo     1375.35      56.15   24.50   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 462.3 on 339 degrees of freedom
Multiple R-squared:  0.6697,    Adjusted R-squared:  0.6677 
F-statistic: 343.6 on 2 and 339 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Here:</p>
<ul>
<li>One level is the <strong>reference</strong> (baseline)</li>
<li>Other coefficients are <strong>differences from that reference</strong></li>
</ul>
<p>Example interpretation:</p>
<ul>
<li>(Intercept) = mean of reference species</li>
<li>speciesChinstrap = difference between Chinstrap and reference</li>
</ul>
<h3 id="with-interactions">With interactions</h3>
<p>Model with interaction term:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ bill_length_mm * species, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-918.76 -245.89   -8.65  238.44 1126.27 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        34.88     443.18   0.079    0.937    
bill_length_mm                     94.50      11.40   8.291 2.73e-15 ***
speciesChinstrap                  811.26     799.81   1.014    0.311    
speciesGentoo                    -158.71     683.19  -0.232    0.816    
bill_length_mm:speciesChinstrap   -35.38      17.75  -1.994    0.047 *  
bill_length_mm:speciesGentoo       14.96      15.79   0.948    0.344    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 371.8 on 336 degrees of freedom
Multiple R-squared:  0.7882,    Adjusted R-squared:  0.7851 
F-statistic: 250.1 on 5 and 336 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Interpretation:</p>
<ul>
<li>Main slope = effect in reference species</li>
<li>Interaction term = <strong>change in slope</strong> for the other species
<ul>
<li>yield ~ variety * fertiliser: how different is the yield for variety A with fertiliser B from yield for variety A with fertiliser A?</li>
</ul></li>
</ul>
<h3 id="the-big-rule">The big rule</h3>
<blockquote>
<p><strong>Every coefficient is a conditional comparison.</strong></p>
</blockquote>
<p>It is always interpreted <strong>given the other terms in the model are held constant</strong>.</p>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="part-c-assumptions-and-diagnostics" class="title-slide slide level1 center">
<h1>Part C — Assumptions and diagnostics</h1>

</section>
<section id="core-assumptions" class="slide level2">
<h2>Core assumptions</h2>
<p>In practice we check these assumptions about <strong>residuals</strong>:</p>
<ol type="1">
<li>Linearity of mean structure</li>
<li>Homoscedasticity (constant variance)</li>
<li>Independence</li>
<li>Approximate normality of residuals (mainly for small samples)</li>
</ol>
</section>
<section id="diagnostic-plots-in-r" class="slide level2">
<h2>Diagnostic plots in R</h2>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"><p>What to look for:</p>
<ul>
<li>Residuals vs fitted: pattern? funnel shape?</li>
<li>Q–Q: strong deviations?</li>
<li>Scale–Location: heteroscedasticity</li>
<li>Residuals vs leverage: influential points</li>
</ul>
</section>
<section id="linearity-residual-pattern" class="slide level2">
<h2>Linearity: residual pattern</h2>
<p>If you see curvature in residuals vs fitted:</p>
<ul>
<li>missing non-linearity (transform x, add polynomial term, or use a better model)</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: body_mass_g ~ bill_length_mm
Model 2: body_mass_g ~ poly(bill_length_mm, 2)
  Res.Df       RSS Df Sum of Sq      F   Pr(&gt;F)   
1    340 141638626                                
2    339 138722819  1   2915807 7.1254 0.007966 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="homoscedasticity-fan-shape" class="slide level2">
<h2>Homoscedasticity: “fan” shape</h2>
<p>If residual spread increases with fitted values:</p>
<ul>
<li>consider transforming the response (e.g., log)</li>
<li>consider robust SEs (later modules), or different model family</li>
</ul>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="independence-design-matters" class="slide level2">
<h2>Independence: design matters</h2>
<p>Independence is usually <strong>not</strong> visible from a single plot.</p>
<p>Breaks happen with:</p>
<ul>
<li>repeated measures (same subject multiple times)</li>
<li>spatial dependence</li>
<li>time series</li>
</ul>
<p>If independence is violated, standard errors can be wrong → misleading p-values.</p>
</section>
<section id="normality-mostly-about-small-sample-inference" class="slide level2">
<h2>Normality: mostly about small-sample inference</h2>
<p>Normal residuals matter most when:</p>
<ul>
<li>sample size is small</li>
<li>you need accurate confidence intervals/tests</li>
</ul>
<p>With moderate/large samples, regression is often robust, but you still diagnose.</p>
</section>
<section id="influential-points" class="slide level2">
<h2>Influential points</h2>
<p>Cook’s distance identifies observations that strongly influence the fit. The top 10 most influential observations:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Body mass (g)</th>
<th style="text-align: right;">Bill length (mm)</th>
<th style="text-align: right;">Cook’s D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3700</td>
<td style="text-align: right;">58.0</td>
<td style="text-align: right;">0.085</td>
</tr>
<tr class="even">
<td style="text-align: right;">4000</td>
<td style="text-align: right;">55.8</td>
<td style="text-align: right;">0.032</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3250</td>
<td style="text-align: right;">51.5</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="even">
<td style="text-align: right;">3450</td>
<td style="text-align: right;">52.2</td>
<td style="text-align: right;">0.026</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3725</td>
<td style="text-align: right;">52.7</td>
<td style="text-align: right;">0.020</td>
</tr>
<tr class="even">
<td style="text-align: right;">6300</td>
<td style="text-align: right;">49.2</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3300</td>
<td style="text-align: right;">50.3</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="even">
<td style="text-align: right;">3400</td>
<td style="text-align: right;">50.5</td>
<td style="text-align: right;">0.017</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3550</td>
<td style="text-align: right;">50.9</td>
<td style="text-align: right;">0.015</td>
</tr>
<tr class="even">
<td style="text-align: right;">3400</td>
<td style="text-align: right;">50.1</td>
<td style="text-align: right;">0.015</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="practical-fixes-not-magic" class="slide level2">
<h2>Practical fixes (not “magic”)</h2>
<p>When assumptions fail:</p>
<ul>
<li><strong>rethink the question</strong> (is linear regression appropriate?)</li>
<li>transform variables (log, sqrt)</li>
<li>add terms (non-linear mean, interactions)</li>
<li>model grouping (blocks/random intercepts)</li>
<li>use alternative families (GLMs) or robust methods</li>
</ul>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="part-d-extensions-youll-meet-soon" class="title-slide slide level1 center">
<h1>Part D — Extensions you’ll meet soon</h1>

</section>
<section id="multiple-regression-main-effects" class="slide level2">
<h2>Multiple regression (main effects)</h2>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \dots + \varepsilon
\]</span></p>
<p>Interpretation: <strong>holding other predictors constant</strong>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term              estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)       -5737.      308.      -18.6  7.80e-54 -6343.     -5131. 
2 bill_length_mm        6.05      5.18      1.17 2.44e- 1    -4.14      16.2
3 flipper_length_mm    48.1       2.01     23.9  7.56e-75    44.2       52.1</code></pre>
</div>
</div>
</section>
<section id="interactions-effect-modification" class="slide level2">
<h2>Interactions (effect modification)</h2>
<p>An interaction means: the effect of <em>x1</em> depends on <em>x2</em>.</p>
<p>Model with interaction between bill length and species:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 46%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">34.88</td>
<td style="text-align: right;">443.18</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">bill_length_mm</td>
<td style="text-align: right;">94.50</td>
<td style="text-align: right;">11.40</td>
<td style="text-align: right;">8.29</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">speciesChinstrap</td>
<td style="text-align: right;">811.26</td>
<td style="text-align: right;">799.81</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">speciesGentoo</td>
<td style="text-align: right;">-158.71</td>
<td style="text-align: right;">683.19</td>
<td style="text-align: right;">-0.23</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bill_length_mm:speciesChinstrap</td>
<td style="text-align: right;">-35.38</td>
<td style="text-align: right;">17.75</td>
<td style="text-align: right;">-1.99</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">bill_length_mm:speciesGentoo</td>
<td style="text-align: right;">14.96</td>
<td style="text-align: right;">15.79</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.34</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Visualise:</p>

<img data-src="regression_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="blocking-fixed-effects-for-batchessites" class="slide level2">
<h2>Blocking (fixed effects for batches/sites)</h2>
<p>Blocks are nuisance structure you <em>control for</em>.</p>
<p>Adding island as a blocking factor:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 22%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1225.79</td>
<td style="text-align: right;">243.18</td>
<td style="text-align: right;">5.04</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">747.45</td>
<td style="text-align: right;">1704.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">bill_length_mm</td>
<td style="text-align: right;">77.12</td>
<td style="text-align: right;">5.31</td>
<td style="text-align: right;">14.53</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">66.68</td>
<td style="text-align: right;">87.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">islandDream</td>
<td style="text-align: right;">-919.07</td>
<td style="text-align: right;">58.62</td>
<td style="text-align: right;">-15.68</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1034.38</td>
<td style="text-align: right;">-803.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">islandTorgersen</td>
<td style="text-align: right;">-523.29</td>
<td style="text-align: right;">85.55</td>
<td style="text-align: right;">-6.12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-691.57</td>
<td style="text-align: right;">-355.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="random-intercepts-preview" class="slide level2">
<h2>Random intercepts (preview)</h2>
<p>If you have repeated measures, you often want:</p>
<p><span class="math display">\[
y_{ij} = \beta_0 + b_{0i} + \beta_1 x_{ij} + \varepsilon_{ij}
\]</span></p>
<ul>
<li>(b_{0i}) is a group-specific intercept deviation (random effect)</li>
</ul>
<p>In R: <code>lme4::lmer()</code> (covered in mixed models).</p>
</section>
<section id="reporting-results-what-good-looks-like" class="slide level2">
<h2>Reporting results (what good looks like)</h2>
<p>Minimum professional reporting:</p>
<ul>
<li>model formula and context (units!)</li>
<li>coefficient estimate with CI (and p-value if required)</li>
<li>a goodness-of-fit statement (R², residual SD)</li>
<li>diagnostics statement (what you checked, any issues)</li>
<li>a plot (scatter + fitted line; residual checks)</li>
</ul>
<p>Example sentence:</p>
<blockquote>
<p>A linear model indicated that body mass increased with bill length (β = … g/mm, 95% CI …), explaining R² = … of variance; residual plots suggested …</p>
</blockquote>
</section>
<section class="slide level2">

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="regression_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="regression_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="regression_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="regression_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="regression_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="regression_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="regression_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="regression_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="regression_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="regression_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>